\subsection*{Algorithm}

The steps are presented in Algorithm~1.\\%\ref{alg:cucb}.
%\begin{algorithm}
%\caption{Clustered UCB($D$)}
%\label{alg:cucb}
\noindent\makebox[\linewidth]{\rule{\textwidth}{0.8pt}}\\[-0.1cm]
\textbf{Algorithm 1:} ClusUCB(p)\\[-0.3cm]
\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}\\[-0.3cm]
\begin{algorithmic}[1]
%\Procedure{\underline{Phase 1: Arm Exploration}}{}
%\State Pull each arm once and calculate $\hat{r}_{i}, \forall i\in A$
\State Let $A$ be the set which contains all the arms
\State Call SubroutineCluster(p)
\State $B_{0}:=A$
%\State $\psi(m)=\dfrac{c}{m}, c>0$
\State $ \epsilon_{0}:=1, w_{0}:=1$
%\State For rounds $m=1,2,.. \lceil\frac{1}{2}\log T\rceil$
\State For rounds $m=0,1,..\big \lfloor \dfrac{1}{2}\log_{2} \dfrac{T}{e}\big\rfloor$
%\State \hspace*{2em} $\hat{\Delta}_{m}=\max_{i\in B_{m}}{\lbrace\hat{r}_{i}\rbrace}-\min_{j\in B_{m}}{\lbrace\hat{r}_{j}\rbrace}$
%\State \hspace*{2em} $\epsilon_{m}=\max{\bigg\lbrace\dfrac{\hat{\Delta}_{m}}{\ell}, \dfrac{2}{\sqrt{\psi{(m)T}}}\bigg\rbrace}$
%, if $\hat{\Delta}_{m}\neq 0$
%\newline\hspace*{3.7em}$=\max{\bigg\lbrace\dfrac{1}{D_{m}}, \dfrac{2}{\sqrt{\psi{(m)T}}}\bigg\rbrace}$, if $\hat{\Delta}_{m}=0$ 
%\todos{(Subho)I think that for $\hat{\Delta}_{m}$ only one condition as specified above is enough for all cases. Even if $\hat{\Delta}_{m}=0$ then $\epsilon_{m}=\dfrac{2}{\sqrt{\psi{(m)T}}}$ as $\dfrac{2}{\sqrt{\psi{(m)T}}}>0$}
%\State \hspace*{2em} Create clusters $s_{i}=\lbrace a_{i}\rbrace, \forall i\in B_{m}$
%\State \hspace*{2em} Merge $s_{i},s_{j}$ into $s_{ij}$ if $\exists a_{i}\in s_{i} $, $ a_{j}\in s_{j},$ such that $|\hat{r}_{i}-\hat{r}_{j}|\leq\epsilon_{m}$ and $|s_{i}|+|s_{j}|\leq \ell$
%\State \hspace*{2em} Call SubroutineMerge
\State \hspace*{2em} Pull each arm in $s_{k}$, \newline\hspace*{2em}$n_{m}=\bigg\lceil\dfrac{2\log{(T\epsilon_{m}^{2})}}{\epsilon_{m}}\bigg\rceil$ number of times, $\forall s_{k}\in S$ 
%\State \hspace*{2em} Calculate $w_{s_{i}}=\bigg\lceil\dfrac{1}{\ell\hat{\Delta}_{s_{i}}}\bigg\rceil$,if $\hat{\Delta}_{s_{i}}\neq 0, \forall s_{i}\in S$
%\newline\hspace*{8em}$=1$, otherwise, and $\hat{\Delta}_{s_{i}}=\max_{i\in s_{i}}{\lbrace\hat{r}_{i}\rbrace}-\min_{j\in s_{i}}{\lbrace\hat{r}_{j}\rbrace}, i\neq j$
\State \hspace*{2em} \textbf{Arm Elimination:}
\newline
\hspace*{2em} Delete all arms $a_{i}\in s_{k}$ for which
\newline\hspace*{2em}$\bigg\lbrace\hat{r}_{i} + \sqrt{\dfrac{\rho_{a}\log{(T\epsilon_{m}^{2})}}{2 n_{m}}} \bigg\rbrace < \max_{a_{j}\in s_{k}}\bigg\lbrace\hat{r}_{j} -\sqrt{\dfrac{\rho_{a}\log{(T\epsilon_{m}^{2})}}{2 n_{m}}} \bigg\rbrace$, $\forall s_{k}\in S$ where $\rho_{a}=\dfrac{1}{w_{m}}$ and remove all such arms from $B_{m}$.
%- \sqrt{\dfrac{\log{(4\psi(m)T\epsilon_{m}^{2})}}{2wn_{s_{i}}}}
\State \hspace*{2em} \textbf{Cluster Elimination:}
\newline
\hspace*{2em} Delete all clusters $s_{k}\in S$ for which $\max_{a_{i}\in s_{k}}\bigg\lbrace\hat{r}_{i} + \sqrt{\dfrac{\rho_{s}\log{(T\epsilon_{m}^{2})}}{2 n_{m}}}\bigg\rbrace  $\newline\hspace*{4em}$< \max_{a_{j}\in B_{m}} \bigg\lbrace\hat{r}_{j} - \sqrt{\dfrac{\rho_{s} \log{(T\epsilon_{m}^{2})}}{2 n_{m}}}\bigg\rbrace$, where $\rho_{s}=\dfrac{1}{w_{m}}$ and remove all such arms in the cluster $s_{k}$ from $B_{m}$ to obtain $B_{m+1}$.
%- \sqrt{\dfrac{(|B_{m}|)\epsilon_{m}\log{(4\psi(m)T\epsilon_{m}^{2})}}{2w\ell_{m} n_{s_{j}}}}
%\newline
%\todo{the max over all arm gives the best global arm, and we compare this with the best payoff arm from each cluster}
\State \hspace*{2em} \textbf{Reset Parameters:}
%\newline \hspace*{2em} Remove all arms from $B_{m}$ which have been eliminated either in arm elimination or cluster elimination condition to obtain $B_{m+1}$
\newline \hspace*{2em} $\epsilon_{m+1}:=\dfrac{\epsilon_{m}}{2},w_{m+1}:=2w_{m}$
%\State \hspace*{2em} $\ell_{m+1}:=\min\lbrace 2\ell_{m}, K\rbrace$
%\State \hspace*{2em} $w_{m+1}:=2w_{m}$
\State \hspace*{2em} \textbf{Stopping Condition:} 
\newline \hspace*{2em} Stop if $|B_{m}|=1$ and pull $\max_{a_{i}\in B_{m}}\hat{r}_{i}$ till $T$ is reached.
\end{algorithmic}
\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}\\[-0.6cm]
\newline
%\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}\\[-0.3cm]
%\textbf{Subroutine:} SubroutineMerge\\[-0.3cm]
%\begin{algorithmic}[1]
%\State \hspace*{2em} Arrange all arms in $B_{m}$ in ascending order based on their $\hat{r}_{i}$
%\State \hspace*{2em} Create clusters $s_{i}=\lbrace a_{i}\rbrace, \forall i\in B_{m}$
%\State \hspace*{2em} For $i=1$ to $K$:
%\State \hspace*{4em} For $j=i+1$ to $K$:
%\State \hspace*{6em} Merge $s_{i},s_{j}$ into $s_{i}$ if $\exists a_{i}\in s_{i} $ and $\exists a_{j}\in s_{j},$ such that $|\hat{r}_{i}-\hat{r}_{j}|\leq\epsilon_{m}$ and $|s_{i}|+|s_{j}|\leq \ell$
%\State \hspace*{2em} Rename all clusters that have been formed as $s_{1}$ to $s_{M}$, where $|S|=M$ after merging
%\end{algorithmic}
%\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}\\[-0.6cm]
\textbf{Subroutine:} SubroutineCluster(p)[Uniform Allocation]\\[-0.3cm]
\begin{algorithmic}[1]
\State \hspace*{2em} $\ell=\bigg\lceil \dfrac{K}{p} \bigg\rceil$
\State \hspace*{2em} Create clusters $s_{i}=\lbrace a_{i}\rbrace, \forall i\in B_{m}$
\State \hspace*{2em} For $i=1$ to $K$:
\State \hspace*{4em} For $j=i+1$ to $K$:
\State \hspace*{6em} Merge $s_{i},s_{j}$ into $s_{i}$ if $\exists a_{i}\in s_{i} $ and $\exists a_{j}\in s_{j},$ such that $|s_{i}|+|s_{j}|\leq \ell$
\State \hspace*{2em} Rename all partitions that have been formed as $s_{1}$ to $s_{p}$, where $|S|=p$ after merging
\end{algorithmic}
\noindent\makebox[\linewidth]{\rule{\textwidth}{0.4pt}}\\[-0.6cm]

%\end{algorithm}



In the above algorithm we are dividing the arm set $A$ into smaller clusters which belong to the cluster set $S$, where after clustering $|S|=p$. We are bounding the cluster size by $\ell$ such that $\ell=\bigg\lceil \dfrac{K}{p} \bigg\rceil$ where $p$ is the number of clusters pre-specified. We uniformly allocate arms in each of the clusters and this is shown in SubroutineCluster($p$).
%For creating these clusters we rely on the parameter $\epsilon_{m}$, which is initialized at $1$ and halved after every round. 
%$\hat{\Delta}_{m}$(in which all $\hat{r}_{i}$ lies) divided by $\ell$. 
%If the range before any round is found to be $0$ then we conduct a small exploration with the alternate definition of $\epsilon_{m}=\dfrac{1}{D_{m}}$. 
%Thus, we see that as the rounds progresses, $\epsilon_{m}$ gets smaller and smaller resulting in tighter and tighter clusters with high purity level. Single link clustering tends to create large clusters with many elements in a single cluster. To avoid this behavior, mainly because we are conducting exploration inside a cluster based on its size, we bound the maximum cluster size possible in any round by $\ell=\min\lbrace 2^{m}, K \rbrace$. Hence as $\epsilon_{m}$ tends to $\Delta$ the upper limit on the cluster size gets fixed. 

We can also see that at any round $m$, the pulls $n_{m}$ increases at a lesser rate compared to the round-based variants UCB-Improved $n_{m}=\bigg\lceil \dfrac{2log(T\tilde{\Delta}_{m}^{2})}{\tilde{\Delta}_{m}^{2}} \bigg\rceil$, where $\tilde{\Delta}_{m}$ is initialized at $1$ and halved after every round or Median-Elimination $\dfrac{4}{\epsilon^{2}}\log\big(\dfrac{3}{\delta}\big)$, where $\epsilon,\delta$ are the parameters for PAC guarantee.

	Next, in each of the round we eliminate arms like UCB-Improved(\cite{auer2010ucb}) or Median Elimination(\cite{even2006action}),however, it is important to note that there is no longer a single point of reference based on which we are eliminating arms but now we have as many reference points to eliminate arms as number of clusters formed that is $p$. We can be this aggressive because we have divided the larger problem into smaller sub-problems, doing local exploration and eliminating sub-optimal arms within each clusters with high guarantee. Hence, compared to UCB-Improved or Median Elimination, the proposed algorithm should have a higher probability of arm deletion. Especially when $K$ is large it is efficient to remove sub-optimal arms quickly rather getting tied down in hopeless exploration. The parameters $\rho_{a}\in (0,1]$ and $\rho_{s}\in (0,1]$ for arm and cluster elimination helps in aggressive elimination of arms and clusters respectively. At the end of each round we update all the  parameters.
%Also our total regret depends on how many arms has survived till $m$-th round and so we don't need to keep track on the number of clusters formed.

%Through cluster elimination condition we ensure that the stopping condition is reached faster. This is a much aggressive elimination condition and in the proofs we give a further analysis on why this works. The parameter $\rho\in (0,1]$ in the confidence interval actually makes the cluster elimination a faster elimination condition than the elimination condition in UCB-Improved.
	
%This is a parameter which we use to tune our exploration and we define its structure later in the proofs. There is also the weight($w_{s_{i}}$) parameter which   is calculated online and helps in eliminating arms with a higher probability which we employ to reduce the cumulative regret and this parameter is decide online specific to the cluster $s_{i}\in S$.
