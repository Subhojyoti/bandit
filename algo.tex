\paragraph{Notation.}
\label{sec:prelims}
\input{prelims}

\subsubsection*{The algorithm}

Algorithm~\ref{alg:clusucb} presents the pseudocode of ClusUCB.

%%%%%%%%%%%%%%%% alg-custom-block %%%%%%%%%%%%
\algblock{ArmElim}{EndArmElim}
\algnewcommand\algorithmicArmElim{\textbf{\em Arm Elimination}}
 \algnewcommand\algorithmicendArmElim{}
\algrenewtext{ArmElim}[1]{\algorithmicArmElim\ #1}
\algrenewtext{EndArmElim}{\algorithmicendArmElim}

\algblock{ClusElim}{EndClusElim}
\algnewcommand\algorithmicClusElim{\textbf{\em Cluster Elimination}}
 \algnewcommand\algorithmicendClusElim{}
\algrenewtext{ClusElim}[1]{\algorithmicClusElim\ #1}
\algrenewtext{EndClusElim}{\algorithmicendClusElim}

\algtext*{EndArmElim}
\algtext*{EndClusElim}

\begin{algorithm}[t]
\caption{ClusUCB}
\label{alg:clusucb}
\begin{algorithmic}
\State {\bf Input:} A partition of $A$ into clusters from Algorithm \ref{alg:rua}, exploration parameters $\rho_a$, $\rho_s$, time horizon $T$.
\State {\bf Initialization:} Set $B_{0}:=A$, $\psi=\log T$ and $\epsilon_{0}:=1$.
%\State For rounds $m=1,2,.. \lceil\frac{1}{2}\log T\rceil$
\For{$m=0,1,..\big \lfloor \dfrac{1}{2}\log_{2} \dfrac{T}{e}\big\rfloor$}	
\State Pull each arm in $s_{k}$ $n_{m}=\bigg\lceil\dfrac{2\log{(\psi T\epsilon_{m}^{2})}}{\epsilon_{m}}\bigg\rceil$ number of times, $\forall s_{k}\in S$ 
%\State \hspace*{2em} Calculate $w_{s_{i}}=\bigg\lceil\dfrac{1}{\ell\hat{\Delta}_{s_{i}}}\bigg\rceil$,if $\hat{\Delta}_{s_{i}}\neq 0, \forall s_{i}\in S$
%\newline\hspace*{8em}$=1$, otherwise, and $\hat{\Delta}_{s_{i}}=\max_{i\in s_{i}}{\lbrace\hat{r}_{i}\rbrace}-\min_{j\in s_{i}}{\lbrace\hat{r}_{j}\rbrace}, i\neq j$
\ArmElim
\State For each cluster $s_k \in S$, delete arm $a_{i}\in s_{k}$ if
$$\hat{r}_{i} + \sqrt{\dfrac{\rho_{a}\log{(\psi T\epsilon_{m}^{2})}}{2 n_{m}}}  < \max_{a_{j}\in s_{k}}\bigg\lbrace\hat{r}_{j} -\sqrt{\dfrac{\rho_{a}\log{(T\epsilon_{m}^{2})}}{2 n_{m}}} \bigg\rbrace.$$
% where $\rho_{a}=\dfrac{1}{w_{m}}$ and remove all such arms from $B_{m}$.
\EndArmElim
\ClusElim
\State Delete cluster $s_{k}\in S$ if 
\begin{align*}
 \max_{a_{i}\in s_{k}}\bigg\lbrace\hat{r}_{i} + \sqrt{\dfrac{\rho_{s}\log{(\psi T\epsilon_{m}^{2})}}{2 n_{m}}}\bigg\rbrace  \\
 < \max_{a_{j}\in B_{m}} \bigg\lbrace\hat{r}_{j} - \sqrt{\dfrac{\rho_{s} \log{(T\epsilon_{m}^{2})}}{2 n_{m}}}\bigg\rbrace.
\end{align*}
%  and remove all such arms in the cluster $s_{k}$ from $B_{m}$ to obtain $B_{m+1}$.
\EndClusElim
\State Set $\epsilon_{m+1}:=\dfrac{\epsilon_{m}}{2}$
%\State \hspace*{2em} $\ell_{m+1}:=\min\lbrace 2\ell_{m}, K\rbrace$
%\State \hspace*{2em} $w_{m+1}:=2w_{m}$
\State Stop if $|B_{m}|=1$ and pull $\max_{a_{i}\in B_{m}}\hat{r}_{i}$ till $T$ is reached.
\EndFor
\end{algorithmic}
\end{algorithm}

ClusUCB begins with a initial clustering of arms that is performed by random uniform allocation - see Algorithm \ref{alg:rua}. The set of clusters $S$ thus obtained satisfies $|S|=p$, with individual clusters having a size that is bounded above by $\ell=\bigg\lceil \dfrac{K}{p} \bigg\rceil$.
%For creating these clusters we rely on the parameter $\epsilon_{m}$, which is initialized at $1$ and halved after every round. 
%$\hat{\Delta}_{m}$(in which all $\hat{r}_{i}$ lies) divided by $\ell$. 
%If the range before any round is found to be $0$ then we conduct a small exploration with the alternate definition of $\epsilon_{m}=\dfrac{1}{D_{m}}$. 
%Thus, we see that as the rounds progresses, $\epsilon_{m}$ gets smaller and smaller resulting in tighter and tighter clusters with high purity level. Single link clustering tends to create large clusters with many elements in a single cluster. To avoid this behavior, mainly because we are conducting exploration inside a cluster based on its size, we bound the maximum cluster size possible in any round by $\ell=\min\lbrace 2^{m}, K \rbrace$. Hence as $\epsilon_{m}$ tends to $\Delta$ the upper limit on the cluster size gets fixed. 

Each round of ClusUCB involves both individual arm as well as cluster elimination conditions that are inspired by UCB-Improved. Notice that, unlike UCB-Improved, there is no longer a single point of reference based on which we are eliminating arms. Instead now we have as many reference points to eliminate arms as number of clusters formed. 
Further, the exploration factors $\rho_{a}\in (0,1]$ and $\rho_{s}\in (0,1]$ governing the arm and cluster elimination conditions, respectively, are relatively more aggressive than that in UCB-Improved. The number $n_m$ of times each arm is pulled per round in ClusUCB is lower than that of UCB-Improved, which used $n_{m}=\bigg\lceil \dfrac{2log(T\epsilon_{m}^{2})}{\epsilon_{m}^{2}} \bigg\rceil$ and Median-Elimination, which used $n_m=\dfrac{4}{\epsilon^{2}}\log\big(\dfrac{3}{\delta}\big)$, where $\epsilon,\delta$ are confidence parameters.

We can be this aggressive because we have divided the larger problem into smaller sub-problems, doing local exploration and eliminating sub-optimal arms within each clusters with high probability. In particular, when $K$ is large and the gaps $\Delta_i$ are small, it is efficient to remove sub-optimal arms quickly rather getting tied down in hopeless exploration. 
The theoretical analysis confirms this intuition, as choosing $\rho_a=\rho_s = \max\lbrace \frac{1}{2},\frac{1}{2^m}\rbrace$ and $\psi_m=K^2T$, ClusUCB is able to achive a better gap-dependent regret upper bound as compared to UCB-Improved and MOSS. 
%Also our total regret depends on how many arms has survived till $m$-th round and so we don't need to keep track on the number of clusters formed.

%Through cluster elimination condition we ensure that the stopping condition is reached faster. This is a much aggressive elimination condition and in the proofs we give a further analysis on why this works. The parameter $\rho\in (0,1]$ in the confidence interval actually makes the cluster elimination a faster elimination condition than the elimination condition in UCB-Improved.
	
%This is a parameter which we use to tune our exploration and we define its structure later in the proofs. There is also the weight($w_{s_{i}}$) parameter which   is calculated online and helps in eliminating arms with a higher probability which we employ to reduce the cumulative regret and this parameter is decide online specific to the cluster $s_{i}\in S$.

\begin{algorithm}[t]
\caption{Clustering by random uniform allocation}
\label{alg:rua}
\begin{algorithmic}
\State Set $\ell=\bigg\lceil \dfrac{K}{p} \bigg\rceil$
\State Permute arms in $A$ randomly to create $A_{random}$.
\State Create clusters $s_{i}=\lbrace a_{i}\rbrace, \forall i\in A_{random}$
\For{ $i=1$ to $K$}
\For{$j=i+1$ to $K$}
\State Merge $s_{i},s_{j}$ into $s_{i}$ if $\exists a_{i}\in s_{i} $ and $\exists a_{j}\in s_{j},$ such that $|s_{i}|+|s_{j}|\leq \ell$
\EndFor
\EndFor
\State Rename all partitions that have been formed as $s_{1}$ to $s_{p}$, where $|S|=p$ after merging
\end{algorithmic}
\end{algorithm}



